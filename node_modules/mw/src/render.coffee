isFunction = (obj) -> '[object Function]' is toString.call obj

module.exports = (view) ->
    throw new Error 'missing view' unless isFunction view
    (req, res, next) ->
        loaded = req.loaded || {}
        console.info 'rendering view with', Object.keys(loaded).toString()
        res.writeHead 200, 'Content-Type': 'text/html; charset=utf-8'
        res.end view loaded
